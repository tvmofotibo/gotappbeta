<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Teste C칙mera, Microfone e Notifica칞칚o</title>

<style>
body {
    font-family: Arial, sans-serif;
    background: #111;
    color: white;
    text-align: center;
    padding: 20px;
}

video {
    width: 100%;
    max-width: 400px;
    border-radius: 10px;
    margin-top: 15px;
    background: black;
}

button {
    padding: 12px 20px;
    margin: 10px;
    border: none;
    border-radius: 8px;
    background: #00ff88;
    font-weight: bold;
    cursor: pointer;
}

button:hover {
    background: #00cc6a;
}
</style>
</head>

<body>

<h2>Teste 游꿘游꿗游댒</h2>

<video id="preview" autoplay playsinline></video>
<br>

<button onclick="iniciar()">Iniciar C칙mera</button>
<button onclick="gravar()">Gravar</button>
<button onclick="parar()">Parar</button>
<button onclick="enviarNotificacao()">Testar Notifica칞칚o</button>

<h3>Reprodu칞칚o:</h3>
<video id="playback" controls></video>

<script>
let stream;
let mediaRecorder;
let chunks = [];

// Iniciar c칙mera e microfone
async function iniciar() {
    try {
        stream = await navigator.mediaDevices.getUserMedia({
            video: { facingMode: "user" },
            audio: true
        });

        const preview = document.getElementById("preview");
        preview.srcObject = stream;
        await preview.play();

    } catch (err) {
        alert("Erro ao acessar c칙mera/microfone: " + err.message);
        console.error(err);
    }
}

// Gravar
function gravar() {
    if (!stream) {
        alert("Inicie a c칙mera primeiro!");
        return;
    }

    chunks = [];
    mediaRecorder = new MediaRecorder(stream);

    mediaRecorder.ondataavailable = e => {
        if (e.data.size > 0) {
            chunks.push(e.data);
        }
    };

    mediaRecorder.onstop = () => {
        const blob = new Blob(chunks, { type: "video/webm" });
        const url = URL.createObjectURL(blob);
        document.getElementById("playback").src = url;
    };

    mediaRecorder.start();
    alert("Gravando...");
}

// Parar grava칞칚o
function parar() {
    if (mediaRecorder && mediaRecorder.state !== "inactive") {
        mediaRecorder.stop();
        alert("Grava칞칚o parada.");
    }
}

// Notifica칞칚o
async function enviarNotificacao() {
    if (!("Notification" in window)) {
        alert("Notifica칞칫es n칚o suportadas nesse dispositivo.");
        return;
    }

    let permissao = await Notification.requestPermission();

    if (permissao === "granted") {
        new Notification("游 GotApp", {
            body: "Notifica칞칚o funcionando!",
            icon: ""
        });
    } else {
        alert("Permiss칚o de notifica칞칚o negada.");
    }
}
</script>

</body>
</html>
