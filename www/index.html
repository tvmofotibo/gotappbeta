<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Teste C칙mera e Microfone</title>

<style>
body {
    font-family: Arial, sans-serif;
    background: #111;
    color: white;
    text-align: center;
    padding: 20px;
}

video {
    width: 100%;
    max-width: 400px;
    border-radius: 10px;
    margin-top: 15px;
}

button {
    padding: 12px 20px;
    margin: 10px;
    border: none;
    border-radius: 8px;
    background: #00ff88;
    font-weight: bold;
    cursor: pointer;
}

button:hover {
    background: #00cc6a;
}
</style>
</head>

<body>

<h2>Teste de Grava칞칚o 游꿘游꿗</h2>

<video id="preview" autoplay muted playsinline></video>
<br>

<button onclick="iniciar()">Iniciar C칙mera</button>
<button onclick="gravar()">Gravar</button>
<button onclick="parar()">Parar</button>

<h3>Reprodu칞칚o:</h3>
<video id="playback" controls></video>

<script>
let stream;
let mediaRecorder;
let chunks = [];

async function iniciar() {
    try {
        stream = await navigator.mediaDevices.getUserMedia({
            video: true,
            audio: true
        });

        document.getElementById("preview").srcObject = stream;

    } catch (err) {
        alert("Erro ao acessar c칙mera/microfone: " + err);
        console.error(err);
    }
}

function gravar() {
    if (!stream) {
        alert("Inicie a c칙mera primeiro!");
        return;
    }

    chunks = [];
    mediaRecorder = new MediaRecorder(stream);

    mediaRecorder.ondataavailable = e => {
        if (e.data.size > 0) {
            chunks.push(e.data);
        }
    };

    mediaRecorder.onstop = () => {
        const blob = new Blob(chunks, { type: "video/webm" });
        const url = URL.createObjectURL(blob);
        document.getElementById("playback").src = url;
    };

    mediaRecorder.start();
    alert("Gravando...");
}

function parar() {
    if (mediaRecorder) {
        mediaRecorder.stop();
        alert("Grava칞칚o parada.");
    }
}
</script>

</body>
</html>

